<!DOCTYPE html>
<html>

<head>
    <title>Benchmarking Snowflake Growth</title>
</head>

<body style="background: black">
    <script src="dist/snowflake.js"></script>
    <script>
        const startTime = performance.now();

        let numSnowflakesGrown = 0;
        const maxSnowflakes = 1000;

        const controller = Main.main();
        const config = controller.defaultConfig();

        window.controller = controller;
        window.config = config;

        config.snowflakeCanvasSizePX = 800;
        config.targetGrowthTimeMS = 0;
        config.upsCap = 10000000;
        config.maxUpdates = 500;
        config.playing = true;
        config.finishedGrowingCallback = () => {
            numSnowflakesGrown += 1;
            if (numSnowflakesGrown < maxSnowflakes) {
                config.snowflakeId = controller.randomSnowflakeId();
                setTimeout(() =>
                    controller.configure(config), 0);
            }
            if (numSnowflakesGrown % 100 === 0) {
                const endTime = performance.now();
                const timeMS = endTime - startTime;
                const timeS = timeMS / 1000;
                const averageMS = timeMS / numSnowflakesGrown;
                console.log(`grew ${numSnowflakesGrown} with average of ${averageMS} milliseconds per snowflake`);
            }
        };

        controller.configure(config);
        controller.installSnowflakeCanvas();
    </script>

</body>

</html>