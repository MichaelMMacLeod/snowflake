var Main;(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{main:()=>B});var n=2*Math.PI/6,r=.0025,o=.3*r,a=[-1,-.75,-.5,-.25,0,.25,.5,.75,1];function i(e,t){return(e%t+t)%t}function c(e,t,n){return(1-n)*e+n*t}function l(e){return[e(),e(),e(),e(),e(),e()]}function h(e){var t=e.r,n=e.g,r=e.b,o=e.a;return"rgba(".concat(t,", ").concat(n,", ").concat(r,", ").concat(o,")")}function g(){for(var e=[0],t=1;t<16;t++)e[t]=Math.floor(9*Math.random());return e[0]=Math.floor(4*Math.random()),e}function s(e,t,n,r,o,a){var i=t.ctx.fillStyle,c=t.ctx.strokeStyle,l=t.ctx.getLineDash(),g=e.options.foregroundColor,s=o?8:5,u=a?[2,2]:[];t.ctx.beginPath(),t.ctx.arc(n,r,3,0,2*Math.PI),t.ctx.closePath(),t.ctx.fillStyle=h(g),t.ctx.fill(),t.ctx.closePath(),t.ctx.beginPath(),t.ctx.arc(n,r,s,0,2*Math.PI),t.ctx.strokeStyle=h(g),t.ctx.setLineDash(u),t.ctx.stroke(),t.ctx.fillStyle=i,t.ctx.strokeStyle=c,t.ctx.setLineDash(l)}function u(e,t,n){var r=t.writableGraphWidth,o=t.writableGraphHeight,i=t.graphMargin;return{x:r/(e.growthInput.length-1)*n+i,y:4*a[e.growthInput[n]]*(o/a.length)+.5*o}}function f(e,t,n){for(var r=1/0,o=0,a=0;a<e.growthInput.length;a+=1){var i=u(e,t,a).x-n.x,c=i*i;c<r&&(r=c,o=a)}return o}var d=[0*n,1*n,2*n,3*n,4*n,5*n];function v(){return{x:0,y:0}}function x(e,t){return{x:e.x+t.x,y:e.y+t.y}}function p(e,t){return{x:e.x+.5*(t.x-e.x),y:e.y+.5*(t.y-e.y)}}function y(e,t,n){return x(w(e,1-n),w(t,n))}function w(e,t){return{x:t*e.x,y:t*e.y}}function b(e,t){return{x:e.x*Math.cos(t)-e.y*Math.sin(t),y:e.x*Math.sin(t)+e.y*Math.cos(t)}}function m(e,t){var n=e.canvas.width,r=e.canvas.height;return{x:t.x*n*.5+.5*n,y:t.y*-r*.5+.5*r}}function S(e){return"none"===e.direction?0:e.direction}function M(e){for(var t="none"===e.direction?0:e.direction,n=l(v),r=0;r<d.length;r+=1){var o=d[(t+r)%d.length];n[r].x=e.center.x+e.size*Math.cos(o),n[r].y=e.center.y+e.size*Math.sin(o)}return n}var T=function(){return T=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},T.apply(this,arguments)};function k(e){var t=d[e.direction],n=e.length;return{x:e.start.x+n*Math.cos(t),y:e.start.y+n*Math.sin(t)}}function E(e){var t=M(function(e){return T(T({},{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0}),{center:(t=e.start,{x:t.x,y:t.y}),size:e.size,direction:e.direction});var t}(e)),n=M(function(e){return T(T({},{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0}),{center:x(e.start,{x:e.length*Math.cos(d[e.direction]),y:e.length*Math.sin(d[e.direction])}),size:e.size,direction:e.direction})}(e));return[n[0],n[1],t[2],t[3],t[4],n[5]]}function C(){return{left:{x:0,y:0},right:{x:0,y:0}}}function G(e){for(var t=l(C),n=0;n<d.length;n+=1)t[n].left=e[(n+1)%d.length],t[n].right=e[n];return t}function P(e,t){return r=function(e,r){return o=e,a=(r+t)%d.length,i=n*(1-a),c=b(o.left,i),l=b(o.right,i),{left:c.x,right:l.x,height:c.y};var o,a,i,c,l},e.map(r,undefined);var r}function L(e,t){if(e.height>t.height&&(e.left<t.left&&e.right>t.left||e.left>t.left&&t.right>e.left||e.left<t.left&&e.right>t.right||e.left>t.left&&e.right<t.right))return e.height-t.height}function z(e){e.eventQueue.forEach((function(t){return function(e,t){if(void 0===e.eventHandlers)throw new Error("state.eventHandlers is undefined");e.eventHandlers[t.kind](t)}(e,t)})),e.eventQueue.length=0,function(e){var t=e.snowflake,n=e.graph,l=e.graphic,g=e.playing,v=e.currentMS,x=e.currentElapsedMS;e.currentMS=performance.now();var w=e.currentMS-v,b=e.allotedGrowthTimeMS/e.targetMSPerUpdate,T=e.allotedGrowthTimeMS/(1e3/60)/b,C=8e3/e.allotedGrowthTimeMS;if(g)if(e.currentElapsedMS+=w,x<e.allotedGrowthTimeMS&&e.currentElapsedMS>=e.allotedGrowthTimeMS)e.finishedGrowingCallbacks.forEach((function(e){return e()}));else{var z=C*T*w/e.targetMSPerUpdate,I=function(e,t){var n=c(0,e.growthInput.length-1,t),r=function(e){return e%1}(n),o=c(a[e.growthInput[Math.floor(n)]],a[e.growthInput[Math.ceil(n)]],r);return{scale:(-.01*n+1)*Math.abs(o),growthType:o>0?"branching":"faceting"}}(n,function(e){return e.currentElapsedMS/e.allotedGrowthTimeMS}(e));void 0===e.currentGrowthType&&(e.currentGrowthType=I.growthType),e.currentGrowthType!==I.growthType&&(e.currentGrowthType=I.growthType,"branching"===e.currentGrowthType?function(e){e.faces.forEach((function(t){t.growing&&(function(e,t){for(var n,r=.01*t.size,o=.001+1*t.size*.99,a=t.center.x,c=t.center.y,l="none"===t.direction?[0,6]:[(n=t.direction,i(n-1,d.length)),3],h=l[1],g=l[0],s=function(n){var i=a+o*Math.cos(d[g]),l=c+o*Math.sin(d[g]),h="none"===t.direction||1===n?.9*t.growthScale:.5*t.growthScale*1;e.branches.push({start:{x:i,y:l},size:r,length:0,direction:g,growthScale:h,growing:!0}),g=function(e){return(e+1)%d.length}(g)},u=0;u<h;u+=1)s(u)}(e,t),t.growing=!1)}))}(t):function(e){e.branches.forEach((function(t){t.growing&&(function(e,t){e.faces.push({center:k(t),size:t.size,direction:t.direction,growthScale:t.growthScale,growing:!0})}(e,t),t.growing=!1)}))}(t)),function(e){e.faces.forEach((function(t,n){var r;t.growing&&(r=t,P(function(e){return G(M(e))}(r),S(r))).forEach((function(r,o){var a=(o+S(t))%d.length;e.faceSideCache[a][n]=r}))})),e.branches.forEach((function(t,n){var r;t.growing&&(r=t,P(function(e){return G(E(e))}(r),r.direction)).forEach((function(r,o){var a=(o+t.direction)%d.length;e.branchSideCache[a][n]=r}))}))}(t),"branching"===e.currentGrowthType?(function(e){e.branches.forEach((function(t,n){if(t.growing){var r=t.direction,o=r,a=i(r-1,d.length),c=e.branchSideCache[o][n],l=e.branchSideCache[a][n];[e.faceSideCache,e.branchSideCache].forEach((function(e,r){for(var i=e[o],h=e[a],g=1===r,s=0;s<i.length;++s)if((!g||s!==n)&&void 0!==L(i[s],c)){t.growing=!1;break}if(t.growing)for(s=0;s<h.length;++s)if((!g||s!==n)&&void 0!==L(h[s],l)){t.growing=!1;break}}))}}))}(t),t.branches.forEach((function(e){e.growing&&function(e,t,n){var a=-1.5*t+1.5,i=1.5*t;e.size+=n*i*o*e.growthScale,e.length+=n*a*r*e.growthScale}(e,I.scale,z)}))):(function(e){e.faces.forEach((function(t,n){if(t.growing){var r=S(t),o=r,a=i(r-1,d.length),c=e.faceSideCache[o][n],l=e.faceSideCache[a][n];[e.faceSideCache,e.branchSideCache].forEach((function(e,r){for(var i=e[o],h=e[a],g=0===r,s=0;s<i.length;++s)if((!g||s!==n)&&void 0!==L(i[s],c)){t.growing=!1;break}if(t.growing)for(s=0;s<h.length;++s)if((!g||s!==n)&&void 0!==L(h[s],l)){t.growing=!1;break}}))}}))}(t),t.faces.forEach((function(e){e.growing&&function(e,t,n){if(e.size+=.75*n*t*r*e.growthScale,"none"!==e.direction){var o=.75*t*r*Math.cos(d[e.direction])*e.growthScale,a=.75*t*r*Math.sin(d[e.direction])*e.growthScale;e.center.x+=n*o,e.center.y+=n*a}}(e,I.scale,z)}))),void 0!==l&&function(e,t,n){t.faces.forEach((function(t){t.growing&&function(e,t,n){"none"===t.direction||t.direction,e.ctx.beginPath();var r=M(t),o=r.map((function(t){return m(e,t)})),a=m(e,r[0]),c=m(e,r[1]),l=(m(e,r[2]),m(e,r[3]),m(e,r[4]),m(e,r[5])),h=m(e,y(r[3],r[1],.2)),g=m(e,y(r[3],r[0],.2)),s=m(e,y(r[3],r[5],.2));if("none"===t.direction){e.ctx.strokeStyle="rgba(255, 255, 255, ".concat(.08*n,")"),r.forEach((function(t,n){var r=m(e,t),o=r.x,a=r.y;0===n?e.ctx.moveTo(o,a):e.ctx.lineTo(o,a)})),e.ctx.closePath(),e.ctx.stroke();var u=m(e,t.center);o.forEach((function(t){e.ctx.beginPath(),e.ctx.moveTo(u.x,u.y),e.ctx.lineTo(t.x,t.y),e.ctx.stroke()}))}else{e.ctx.strokeStyle="rgba(255, 255, 255, ".concat(.08*n,")"),e.ctx.beginPath();var f=m(e,p(r[4],r[5]));e.ctx.moveTo(f.x,f.y),e.ctx.lineTo(l.x,l.y),e.ctx.stroke(),e.ctx.beginPath();var d=m(e,p(r[2],r[1]));e.ctx.moveTo(d.x,d.y),e.ctx.lineTo(c.x,c.y),e.ctx.stroke();for(var v=0;v<3;++v){var x=m(e,r[i(v-1,r.length)]),w=x.x,b=x.y;0===v?e.ctx.moveTo(w,b):e.ctx.lineTo(w,b)}e.ctx.stroke(),e.ctx.beginPath(),e.ctx.moveTo(h.x,h.y),e.ctx.lineTo(c.x,c.y),e.ctx.stroke(),e.ctx.beginPath(),e.ctx.moveTo(g.x,g.y),e.ctx.lineTo(a.x,a.y),e.ctx.stroke(),e.ctx.beginPath(),e.ctx.moveTo(s.x,s.y),e.ctx.lineTo(l.x,l.y),e.ctx.stroke()}}(e,t,n)})),t.branches.forEach((function(t){t.growing&&function(e,t,n){e.ctx.beginPath();for(var r=E(t),o=0;o<3;++o){var a=m(e,r[i(o-1,r.length)]),c=a.x,l=a.y;0===o?e.ctx.moveTo(c,l):e.ctx.lineTo(c,l)}e.ctx.strokeStyle="rgba(255, 255, 255, ".concat(.2*n,")"),e.ctx.stroke(),e.ctx.strokeStyle="rgba(255, 255, 255, ".concat(.08*n,")"),e.ctx.beginPath();var h=m(e,p(r[4],r[5]));e.ctx.moveTo(h.x,h.y);var g=m(e,r[5]);e.ctx.lineTo(g.x,g.y),e.ctx.stroke(),e.ctx.beginPath();var s=m(e,p(r[2],r[1]));e.ctx.moveTo(s.x,s.y);var u=m(e,r[1]);e.ctx.lineTo(u.x,u.y),e.ctx.stroke(),e.ctx.strokeStyle="rgba(255, 255, 255, ".concat(.2*n,")"),e.ctx.beginPath();var f=m(e,r[0]);e.ctx.moveTo(f.x,f.y);var d=m(e,p(r[3],r[0]));e.ctx.lineTo(d.x,d.y),e.ctx.stroke()}(e,t,n)}))}(l,t,z)}var D=e.currentElapsedMS/e.allotedGrowthTimeMS;!function(e,t){!function(e,t,n){void 0===e.installation?n():t(e.installation)}(e,t,(function(){}))}(n,(function(e){(function(e,t){if(void 0!==t.handleBeingDragged||t.mouseRecentlyExitedGraph){t.mouseRecentlyExitedGraph=!1;var n="needs lookup"===t.handleBeingDragged&&void 0!==t.graphMouse?f(e,t,t.graphMouse):t.handleBeingDragged;if("needs lookup"===t.handleBeingDragged&&(t.handleBeingDragged=n),void 0!==t.graphMouse&&"needs lookup"!==n){var r=t.writableGraphHeight/a.length,o=Math.floor(t.graphMouse.y/r);void 0!==n&&(e.growthInput[n]=(i=o,c=a.length-1,Math.min(Math.max(i,0),c)))}}var i,c,l=void 0!==t.handleBeingDragged?"none":"auto",h=function(e){return e.setAttribute("style","user-select: ".concat(l))};Array.from(document.getElementsByClassName("graphLabel")).forEach(h),Array.from(document.getElementsByClassName("control")).forEach(h);var g=document.getElementById("controlContainer");null!==g&&h(g)})(n,e),e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),function(e,t,n){var r=t.writableGraphWidth,o=t.writableGraphHeight,a=t.graphMargin,i=t.ctx.fillStyle;t.ctx.fillStyle=h(e.options.progressColor),t.ctx.fillRect(a,0,r*n,o),t.ctx.fillStyle=i,t.ctx.beginPath();var c=u(e,t,0);t.ctx.moveTo(c.x,c.y);for(var l=1;l<e.growthInput.length;l+=1)c=u(e,t,l),t.ctx.lineTo(c.x,c.y);for(t.ctx.strokeStyle=h(e.options.foregroundColor),t.ctx.stroke(),l=0;l<e.growthInput.length;l+=1)if(c=u(e,t,l),void 0!==t.graphMouse){var g=f(e,t,t.graphMouse);s(e,t,c.x,c.y,l===g,l===t.handleBeingDragged)}else s(e,t,c.x,c.y,!1,!1);t.ctx.beginPath();var d=r*n+a;t.ctx.moveTo(d,0),t.ctx.lineTo(d,o),t.ctx.strokeStyle=h(e.options.progressLineColor),t.ctx.stroke(),t.ctx.beginPath();var v=.5*o;t.ctx.moveTo(a,v),t.ctx.lineTo(r+a,v),t.ctx.strokeStyle=h(e.options.foregroundColor),t.ctx.setLineDash([2,2]),t.ctx.stroke(),t.ctx.setLineDash([])}(n,e,D)}))}(e)}function I(){var e,t={graph:{options:{progressColor:{r:255,g:255,b:255,a:1},progressLineColor:{r:255,g:255,b:255,a:1},backgroundColor:{r:0,g:0,b:0,a:1},foregroundColor:{r:0,g:0,b:0,a:1}},growthInput:g(),installation:void 0},graphic:void 0,snowflake:{faces:[{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0}],branches:[],faceSideCache:l((function(){return[]})),branchSideCache:l((function(){return[]}))},currentGrowthType:void 0,currentMS:0,currentElapsedMS:0,allotedGrowthTimeMS:8e3,targetMSPerUpdate:1e3/60,playing:!1,eventQueue:[],eventHandlers:void 0,eventHandlerTimeout:void 0,finishedGrowingCallbacks:[],resetCallbacks:[]};return t.eventHandlers=(e=t,{installSnowflake:function(t){var n=t.options,r=t.installCanvas,o=t.onNoContextFailure;if(void 0!==e.graphic)throw new Error("snowflake already installed");e.graphic=function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.className=e.className;var n=t.getContext("2d");if(null!==n)return{canvas:t,ctx:n}}(n),void 0===e.graphic?o():r(e.graphic.canvas)},installGraph:function(t){var n=t.options,r=t.installCanvas,o=t.onNoContextFailure;!function(e,t){if(void 0===e.installation){var n=document.createElement("canvas");n.width=t.canvasWidth,n.height=t.canvasHeight,n.className=t.canvasClassName;var r=n.getContext("2d");null!==r&&(n.addEventListener("mousemove",o),n.addEventListener("mousedown",a),n.addEventListener("mouseleave",c),t.mouseUpEventListenerNode.addEventListener("mouseup",i),e.installation={options:t,canvas:n,ctx:r,handleBeingDragged:void 0,mouseRecentlyExitedGraph:!1,graphMouse:void 0,graphMargin:10,writableGraphWidth:n.width-20,writableGraphHeight:n.height,removeEventListeners:function(){n.removeEventListener("mousemove",o),n.removeEventListener("mousedown",a),n.removeEventListener("mouseleave",c),t.mouseUpEventListenerNode.removeEventListener("mouseup",i)}})}else console.error("attempt to install graph twice");function o(t){void 0!==e.installation&&(e.installation.graphMouse={x:t.offsetX,y:t.offsetY})}function a(){void 0!==e.installation&&(e.installation.handleBeingDragged="needs lookup")}function i(){void 0!==e.installation&&(e.installation.handleBeingDragged=void 0,e.installation.graphMouse=void 0)}function c(){void 0!==e.installation&&(e.installation.mouseRecentlyExitedGraph=!0)}}(e.graph,n),void 0===e.graph.installation?o():r(e.graph.installation.canvas)},play:function(t){var n=t.play;e.playing="toggle"===n?!e.playing:n},reset:function(t){var n;!function(e){e.faces.length=1,e.faces[0]={center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0},e.branches.length=0;for(var t=0;t<d.length;++t)e.faceSideCache[t].length=0,e.branchSideCache[t].length=0}(e.snowflake),e.currentElapsedMS=0,e.currentGrowthType=void 0,void 0!==e.graphic&&(n=e.graphic).ctx.clearRect(0,0,n.canvas.width,n.canvas.height),e.resetCallbacks.forEach((function(e){return e()}))},randomize:function(t){e.graph.growthInput=g()},halt:function(t){var n;clearInterval(e.eventHandlerTimeout),null===(n=e.graph.installation)||void 0===n||n.removeEventListeners()},registerFinishedGrowingCallback:function(t){var n=t.callback;e.finishedGrowingCallbacks.push(n)},registerResetCallback:function(t){var n=t.callback;e.resetCallbacks.push(n)}}),t.eventHandlerTimeout=setInterval((function(){return z(t)}),t.targetMSPerUpdate),t}function D(e,t){e.eventQueue.push(t)}function B(){return e=I(),{handle:function(t){return D(e,t)},handleAll:function(t){return t.forEach((function(t){return D(e,t)}))}};var e}Main=t})();