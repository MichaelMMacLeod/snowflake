(()=>{"use strict";var t=2*Math.PI/6,e=.001,n=[-1,-.75,-.5,-.25,0,.25,.5,.75,1];function r(t,e){return(t%e+e)%e}function i(t,e,n){return(1-n)*t+n*e}function o(t){return[t(),t(),t(),t(),t(),t()]}function a(){for(var t=[0],e=0;e<16;e++)t[e]=Math.floor(9*Math.random());return t}function c(t,e,n,r,i){var o=t.ctx.fillStyle,a=t.ctx.strokeStyle,c=t.ctx.getLineDash(),h="black",g=r?8:5,l=i?[2,2]:[];t.ctx.beginPath(),t.ctx.arc(e,n,3,0,2*Math.PI),t.ctx.closePath(),t.ctx.fillStyle=h,t.ctx.fill(),t.ctx.closePath(),t.ctx.beginPath(),t.ctx.arc(e,n,g,0,2*Math.PI),t.ctx.strokeStyle=h,t.ctx.setLineDash(l),t.ctx.stroke(),t.ctx.fillStyle=o,t.ctx.strokeStyle=a,t.ctx.setLineDash(c)}function h(t,e,r,i,o){return{x:e/(t.growthInput.length-1)*o+i,y:4*n[t.growthInput[o]]*(r/n.length)+.5*r}}function g(t){t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height)}var l=[0*t,1*t,2*t,3*t,4*t,5*t];function u(){return{x:0,y:0}}function s(t,e){return{x:t.x*Math.cos(e)-t.y*Math.sin(e),y:t.x*Math.sin(e)+t.y*Math.cos(e)}}function f(t,e){var n=t.canvas.width,r=t.canvas.height;return{x:e.x*n*.5+.5*n,y:e.y*-r*.5+.5*r}}function d(t){return"none"===t.direction?0:t.direction}function v(t){for(var e="none"===t.direction?0:t.direction,n=o(u),r=0;r<l.length;r+=1){var i=l[(e+r)%l.length];n[r].x=t.center.x+t.size*Math.cos(i),n[r].y=t.center.y+t.size*Math.sin(i)}return n}var x,p=function(){return p=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},p.apply(this,arguments)};function y(t){var e=l[t.direction],n=t.length;return{x:t.start.x+n*Math.cos(e),y:t.start.y+n*Math.sin(e)}}function w(t){var e=v(function(t){return p(p({},{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0}),{center:(e=t.start,{x:e.x,y:e.y}),size:t.size,direction:t.direction});var e}(t)),n=v(function(t){return p(p({},{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0}),{center:(e=t.start,n={x:t.length*Math.cos(l[t.direction]),y:t.length*Math.sin(l[t.direction])},{x:e.x+n.x,y:e.y+n.y}),size:t.size,direction:t.direction});var e,n}(t));return[n[0],n[1],e[2],e[3],e[4],n[5]]}function b(){return{left:{x:0,y:0},right:{x:0,y:0}}}function m(t){for(var e=o(b),n=0;n<l.length;n+=1)e[n].left=t[(n+1)%l.length],e[n].right=t[n];return e}function M(e,n){return r=function(e,r){return o=t*(1-(r+n)%l.length),a=s((i=e).left,o),c=s(i.right,o),{left:a.x,right:c.x,height:a.y};var i,o,a,c},e.map(r,undefined);var r}function E(t,e){if(t.height>e.height&&(t.left<e.left&&t.right>e.left||t.left>e.left&&e.right>t.left||t.left<e.left&&t.right>e.right||t.left>e.left&&t.right<e.right))return t.height-e.height}function S(t,e){for(var n=t.writableGraphWidth,r=t.writableGraphHeight,i=t.graphMargin,o=t.graph,a=1/0,c=0,g=0;g<o.growthInput.length;g+=1){var l=h(o,n,r,i,g).x-e.x,u=l*l;u<a&&(a=u,c=g)}return c}function k(t){var o=t.snowflake,a=t.graph,u=t.graphic,s=t.maxSteps,x=t.controls;if(t.step<s&&x.playing){t.step+=1;var p=function(t,e){var r=i(0,t.growthInput.length-1,e),o=function(t){return t%1}(r),a=i(n[t.growthInput[Math.floor(r)]],n[t.growthInput[Math.ceil(r)]],o);return{scale:(-.01*r+1)*Math.abs(a),growthType:a>0?"branching":"faceting"}}(a,function(t){return t.step/t.maxSteps}(t));void 0===t.currentGrowthType&&(t.currentGrowthType=p.growthType),t.currentGrowthType!==p.growthType&&(t.currentGrowthType=p.growthType,"branching"===t.currentGrowthType?function(t){t.faces.forEach((function(e){e.growing&&(function(t,e){for(var n,i=.01*e.size,o=.001+1*e.size*.99,a=e.center.x,c=e.center.y,h="none"===e.direction?[0,6]:[(n=e.direction,r(n-1,l.length)),3],g=h[1],u=h[0],s=function(n){var r=a+o*Math.cos(l[u]),h=c+o*Math.sin(l[u]),g="none"===e.direction||1===n?.9*e.growthScale:.5*e.growthScale*1;t.branches.push({start:{x:r,y:h},size:i,length:0,direction:u,growthScale:g,growing:!0}),u=function(t){return(t+1)%l.length}(u)},f=0;f<g;f+=1)s(f)}(t,e),e.growing=!1)}))}(o):function(t){t.branches.forEach((function(e){e.growing&&(function(t,e){t.faces.push({center:y(e),size:e.size,direction:e.direction,growthScale:e.growthScale,growing:!0})}(t,e),e.growing=!1)}))}(o));var b=function(t){var e=[[],[],[],[],[],[]];return t.faces.forEach((function(t){var n;(n=t,M(function(t){return m(v(t))}(n),d(n))).forEach((function(n,r){var i=(r+d(t))%l.length;e[i].push(n)}))})),t.branches.forEach((function(t){var n;(n=t,M(function(t){return m(w(t))}(n),n.direction)).forEach((function(n,r){var i=(r+t.direction)%l.length;e[i].push(n)}))})),e}(o);"branching"===t.currentGrowthType?(function(t,e){t.branches.forEach((function(n,i){if(i+=t.faces.length,n.growing){for(var o=n.direction,a=o,c=r(o-1,l.length),h=e[a][i],g=e[c][i],u=e[a],s=e[c],f=0;f<u.length;++f)if(f!==i&&void 0!==E(u[f],h)){n.growing=!1;break}if(n.growing)for(f=0;f<s.length;++f)if(f!==i&&void 0!==E(s[f],g)){n.growing=!1;break}}}))}(o,b),o.branches.forEach((function(t){var n,r,i,o;t.growing&&(n=t,i=-1.5*(r=p.scale)+1.5,o=1.5*r,n.size+=3e-4*o*n.growthScale,n.length+=i*e*n.growthScale)}))):(function(t,e){t.faces.forEach((function(t,n){if(t.growing){for(var i=d(t),o=i,a=r(i-1,l.length),c=e[o][n],h=e[a][n],g=e[o],u=e[a],s=0;s<g.length;++s)if(s!==n&&void 0!==E(g[s],c)){t.growing=!1;break}if(t.growing)for(s=0;s<u.length;++s)if(s!==n&&void 0!==E(u[s],h)){t.growing=!1;break}}}))}(o,b),o.faces.forEach((function(t){t.growing&&function(t,n){if(t.size+=.75*n*e*t.growthScale,"none"!==t.direction){var r=.75*n*e*Math.cos(l[t.direction])*t.growthScale,i=.75*n*e*Math.sin(l[t.direction])*t.growthScale;t.center.x+=r,t.center.y+=i}}(t,p.scale)}))),g(u),function(t,e){e.faces.forEach((function(e){return function(t,e){"none"===e.direction||e.direction,t.ctx.beginPath(),v(e).forEach((function(e,n){var r=f(t,e),i=r.x,o=r.y;0===n?t.ctx.moveTo(i,o):t.ctx.lineTo(i,o)})),t.ctx.closePath(),t.ctx.fillStyle="rgba(255, 255, 255, 1)",t.ctx.fill()}(t,e)})),e.branches.forEach((function(e){return function(t,e){t.ctx.beginPath(),w(e).forEach((function(e,n){var r=f(t,e),i=r.x,o=r.y;0===n?t.ctx.moveTo(i,o):t.ctx.lineTo(i,o)})),t.ctx.closePath(),t.ctx.fillStyle="rgba(255, 255, 255, 1)",t.ctx.fill()}(t,e)}))}(u,o)}(function(t){var e,r,i=t.graph,o=t.writableGraphHeight;if(void 0!==i.handleBeingDragged||i.mouseRecentlyExitedGraph){i.mouseRecentlyExitedGraph=!1;var a="needs lookup"===i.handleBeingDragged&&void 0!==i.graphMouse?S(t,i.graphMouse):i.handleBeingDragged;if("needs lookup"===i.handleBeingDragged&&(i.handleBeingDragged=a),void 0!==i.graphMouse&&"needs lookup"!==a){var c=o/n.length,h=Math.floor(i.graphMouse.y/c);void 0!==a&&(i.growthInput[a]=(e=h,r=n.length-1,Math.min(Math.max(e,0),r)))}}var g=void 0!==i.handleBeingDragged?"none":"auto",l=function(t){return t.setAttribute("style","user-select: ".concat(g))};Array.from(document.getElementsByClassName("graphLabel")).forEach(l),Array.from(document.getElementsByClassName("control")).forEach(l);var u=document.getElementById("controlContainer");null!==u&&l(u)})(t),a.ctx.clearRect(0,0,a.canvas.width,a.canvas.height),function(t){var e=t.graph,n=t.writableGraphWidth,r=t.writableGraphHeight,i=t.graphMargin,o=t.step/t.maxSteps,a=e.ctx.fillStyle;e.ctx.fillStyle=e.background,e.ctx.fillRect(i,0,n*o,r),e.ctx.fillStyle=a,e.ctx.beginPath();var g=h(e,n,r,i,0);e.ctx.moveTo(g.x,g.y);for(var l=1;l<e.growthInput.length;l+=1)g=h(e,n,r,i,l),e.ctx.lineTo(g.x,g.y);for(e.ctx.strokeStyle="black",e.ctx.stroke(),l=0;l<e.growthInput.length;l+=1)if(g=h(e,n,r,i,l),void 0!==e.graphMouse){var u=S(t,e.graphMouse);c(e,g.x,g.y,l===u,l===e.handleBeingDragged)}else c(e,g.x,g.y,!1,!1);e.ctx.beginPath();var s=n*o+i;e.ctx.moveTo(s,0),e.ctx.lineTo(s,r),e.ctx.strokeStyle="blue",e.ctx.stroke(),e.ctx.beginPath();var f=.5*r;e.ctx.moveTo(i,f),e.ctx.lineTo(n+i,f),e.ctx.strokeStyle="black",e.ctx.setLineDash([2,2]),e.ctx.stroke(),e.ctx.setLineDash([])}(t)}void 0!==(x=function(){var t=function(){var t=document.getElementById("graph"),e=t.getContext("2d");if(null!==e){var n={canvas:t,ctx:e,handleBeingDragged:void 0,mouseRecentlyExitedGraph:!1,graphMouse:void 0,background:"rgba(203, 203, 255, 1)",growthInput:a()};return t.addEventListener("mousemove",(function(t){n.graphMouse={x:t.offsetX,y:t.offsetY}})),t.addEventListener("mousedown",(function(t){n.handleBeingDragged="needs lookup"})),document.addEventListener("mouseup",(function(t){n.handleBeingDragged=void 0,n.graphMouse=void 0})),t.addEventListener("mouseleave",(function(t){n.mouseRecentlyExitedGraph=!0})),n}}(),e=function(){var t=document.getElementById("snowflake"),e=t.getContext("2d");if(null!==e)return e.fillStyle="rgba(90, 211, 255, 1.0)",{canvas:t,ctx:e}}();if(void 0!==t&&void 0!==e)return{graph:t,graphic:e,snowflake:{faces:[{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0}],branches:[]},currentGrowthType:void 0,graphMargin:10,writableGraphWidth:t.canvas.width-20,writableGraphHeight:t.canvas.height,controls:{pause:document.getElementById("pause"),reset:document.getElementById("reset"),playing:!0},step:0,intervalId:void 0,updateInterval:5,maxSteps:1e3};console.error("Couldn't get drawing context")}())&&(function(t){var e=t.controls,n=t.graphic;e.pause.addEventListener("click",(function(t){e.playing=!e.playing,e.playing?(e.pause.innerHTML="pause",n.canvas.className=""):(e.pause.innerHTML="play",n.canvas.className="paused")})),e.reset.addEventListener("click",(function(e){!function(t){var e;(e=t.snowflake).faces.length=1,e.faces[0]={center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0},e.branches.length=0,t.step=0,t.currentGrowthType=void 0,g(t.graphic)}(t)}))}(x),x.intervalId=window.setInterval((function(){return k(x)}),x.updateInterval))})();