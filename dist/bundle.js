(()=>{"use strict";var e=function(){return e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},e.apply(this,arguments)},t=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))};var n=2*Math.PI/6,r=[0*n,1*n,2*n,3*n,4*n,5*n];var a={center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,id:0};function i(e){var t=r[e.direction],n=e.length;return{x:e.start.x+n*Math.cos(t),y:e.start.y+n*Math.sin(t)}}function o(e,t){var n=e.canvas.width,r=e.canvas.height;return{x:t.x*n*.5+.5*n,y:t.y*-r*.5+.5*r}}function c(e,t){"none"===t.direction||t.direction,e.ctx.beginPath(),m(t).forEach((function(t,n){var r=o(e,t),a=r.x,i=r.y;0===n?e.ctx.moveTo(a,i):e.ctx.lineTo(a,i)})),e.ctx.closePath(),e.ctx.fillStyle="rgba(203, 203, 255, 1)",e.ctx.fill()}function s(t,n){t.ctx.beginPath(),function(t){var n=[],i=m(function(t){return e(e({},a),{center:(n=t.start,{x:n.x,y:n.y}),size:t.size,direction:t.direction});var n}(t)),o=m(function(t){return e(e({},a),{center:(n=t.start,i={x:t.length*Math.cos(r[t.direction]),y:t.length*Math.sin(r[t.direction])},{x:n.x+i.x,y:n.y+i.y}),size:t.size,direction:t.direction});var n,i}(t));return n.push(o[0]),n.push(o[1]),n.push(i[2]),n.push(i[3]),n.push(i[4]),n.push(o[5]),n}(n).forEach((function(e,n){var r=o(t,e),a=r.x,i=r.y;0===n?t.ctx.moveTo(a,i):t.ctx.lineTo(a,i)})),t.ctx.closePath(),t.ctx.fill()}var g=.001;function h(e){return e.faces.waiting.length+e.faces.grown.length+e.branches.growing.length+e.branches.grown.length}var l,u=function(){for(var e=[0],t=0;t<16;t++)e[t]=Math.floor(9*Math.random());return e}(),f=[-1,-.75,-.5,-.25,0,.25,.5,.75,1];function d(e,t,n,r,a){var i=e.ctx.fillStyle,o=e.ctx.strokeStyle,c=e.ctx.getLineDash(),s="black",g=r?8:5,h=a?[2,2]:[];e.ctx.beginPath(),e.ctx.arc(t,n,3,0,2*Math.PI),e.ctx.closePath(),e.ctx.fillStyle=s,e.ctx.fill(),e.ctx.closePath(),e.ctx.beginPath(),e.ctx.arc(t,n,g,0,2*Math.PI),e.ctx.strokeStyle=s,e.ctx.setLineDash(h),e.ctx.stroke(),e.ctx.fillStyle=i,e.ctx.strokeStyle=o,e.ctx.setLineDash(c)}function p(e,t,n,r){return{x:e/(u.length-1)*r+n,y:4*f[u[r]]*(t/f.length)+.5*t}}function v(e,t){for(var n=e.writableGraphWidth,r=e.writableGraphHeight,a=e.graphMargin,i=1/0,o=0,c=0;c<u.length;c+=1){var s=p(n,r,a,c).x-t.x,g=s*s;g<i&&(i=g,o=c)}return o}function x(e,t,n){return(1-n)*e+n*t}function w(e,t){for(var n=0,r=0,a=0;r<e.length;)e[r]===t[a]?a+=1:(e[n]=e[r],n+=1),r+=1;e.splice(n)}function y(e){var n,a,o,l,y=e.snowflake,m=e.graph,M=e.graphic,S=e.maxSteps,E=e.controls;if(e.step<S&&E.playing){e.step+=1;var k=(n=function(e){return e.step/e.maxSteps}(e),o=function(e){return e%1}(a=x(0,u.length-1,n)),l=x(f[u[Math.floor(a)]],f[u[Math.ceil(a)]],o),{scale:(-.01*a+1)*Math.abs(l),growthType:l>0?"branching":"faceting"});void 0===e.currentGrowthType&&(e.currentGrowthType=k.growthType),e.currentGrowthType!==k.growthType&&(e.currentGrowthType=k.growthType,"branching"===e.currentGrowthType?function(e){e.faces.growing.forEach((function(t){e.faces.waiting.push(t),function(e,t){for(var n=.01*t.size,a=1*t.size*.99,i=t.center.x,o=t.center.y,c="none"===t.direction?[0,6]:[(f=t.direction,d=void 0,((f-1)%(d=r.length)+d)%d),3],s=c[1],g=c[0],l=function(c){var s=i+a*Math.cos(r[g]),l=o+a*Math.sin(r[g]),u="none"===t.direction||1===c?.9*t.growthScale:.5*t.growthScale*1;e.branches.growing.push({rayHits:0,start:{x:s,y:l},size:n,length:0,direction:g,growthScale:u,id:h(e)}),g=(g+1)%r.length},u=0;u<s;u+=1)l(u);var f,d}(e,t)}))}(y):function(e){e.branches.growing.forEach((function(t){e.branches.waiting.push(t),function(e,t){e.faces.growing.push({center:i(t),size:t.size,direction:t.direction,growthScale:t.growthScale,id:h(e)})}(e,t)}))}(y)),function(e){var n,r,a=function(e,t){return e.id-t.id},i=function(e,t){return e.id-t.id};e.faces.growing.sort(a),e.faces.grown.sort(a),e.faces.waiting.sort(a),e.branches.growing.sort(i),e.branches.grown.sort(i),e.branches.waiting.sort(i),w(e.faces.growing,e.faces.waiting),w(e.branches.growing,e.branches.waiting),(n=e.faces.grown).splice.apply(n,t([e.faces.grown.length,0],e.faces.waiting,!1)),(r=e.branches.grown).splice.apply(r,t([e.branches.grown.length,0],e.branches.waiting,!1)),e.faces.waiting.splice(0),e.branches.waiting.splice(0)}(y),"branching"===e.currentGrowthType?function(e,t){e.branches.growing.forEach((function(e){var n=-1.5*t+1.5,r=1.5*t;e.size+=3e-4*r*e.growthScale,e.length+=n*g*e.growthScale}))}(y,k.scale):function(e,t){e.faces.growing.forEach((function(e){if(e.size+=.75*t*g*e.growthScale,"none"!==e.direction){var n=.75*t*g*Math.cos(r[e.direction])*e.growthScale,a=.75*t*g*Math.sin(r[e.direction])*e.growthScale;e.center.x+=n,e.center.y+=a}}))}(y,k.scale),b(M),function(e,t){t.faces.growing.forEach((function(t){c(e,t)})),t.faces.grown.forEach((function(t){return c(e,t)})),t.branches.growing.forEach((function(t){s(e,t)})),t.branches.grown.forEach((function(t){return s(e,t)}))}(M,y)}(function(e){var t,n,r=e.graph,a=e.writableGraphHeight;if(void 0!==r.handleBeingDragged||r.mouseRecentlyExitedGraph){r.mouseRecentlyExitedGraph=!1;var i="needs lookup"===r.handleBeingDragged&&void 0!==r.graphMouse?v(e,r.graphMouse):r.handleBeingDragged;if("needs lookup"===r.handleBeingDragged&&(r.handleBeingDragged=i),void 0!==r.graphMouse&&"needs lookup"!==i){var o=a/f.length,c=Math.floor(r.graphMouse.y/o);void 0!==i&&(u[i]=(t=c,n=f.length-1,Math.min(Math.max(t,0),n)))}}var s=void 0!==r.handleBeingDragged?"none":"auto",g=function(e){return e.setAttribute("style","user-select: ".concat(s))};Array.from(document.getElementsByClassName("graphLabel")).forEach(g),Array.from(document.getElementsByClassName("control")).forEach(g);var h=document.getElementById("controlContainer");null!==h&&g(h)})(e),m.ctx.clearRect(0,0,m.canvas.width,m.canvas.height),function(e){var t=e.graph,n=e.writableGraphWidth,r=e.writableGraphHeight,a=e.graphMargin,i=e.step/e.maxSteps,o=t.ctx.fillStyle;t.ctx.fillStyle=t.background,t.ctx.fillRect(a,0,n*i,r),t.ctx.fillStyle=o,t.ctx.beginPath();var c=p(n,r,a,0);t.ctx.moveTo(c.x,c.y);for(var s=1;s<u.length;s+=1)c=p(n,r,a,s),t.ctx.lineTo(c.x,c.y);for(t.ctx.strokeStyle="black",t.ctx.stroke(),s=0;s<u.length;s+=1)if(c=p(n,r,a,s),void 0!==t.graphMouse){var g=v(e,t.graphMouse);d(t,c.x,c.y,s===g,s===t.handleBeingDragged)}else d(t,c.x,c.y,!1,!1);t.ctx.beginPath();var h=n*i+a;t.ctx.moveTo(h,0),t.ctx.lineTo(h,r),t.ctx.strokeStyle="blue",t.ctx.stroke(),t.ctx.beginPath();var l=.5*r;t.ctx.moveTo(a,l),t.ctx.lineTo(n+a,l),t.ctx.strokeStyle="black",t.ctx.setLineDash([2,2]),t.ctx.stroke(),t.ctx.setLineDash([])}(e)}function b(e){e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height)}function m(e){for(var t="none"===e.direction?0:e.direction,n=[],a=0;a<r.length;a+=1){var i=r[(t+a)%r.length];n.push({x:e.center.x+e.size*Math.cos(i),y:e.center.y+e.size*Math.sin(i)})}return n}void 0!==(l=function(){var e=function(){var e=document.getElementById("graph"),t=e.getContext("2d");if(null!==t){var n={canvas:e,ctx:t,handleBeingDragged:void 0,mouseRecentlyExitedGraph:!1,graphMouse:void 0,background:"rgba(203, 203, 255, 1)"};return e.addEventListener("mousemove",(function(e){n.graphMouse={x:e.offsetX,y:e.offsetY}})),e.addEventListener("mousedown",(function(e){n.handleBeingDragged="needs lookup"})),document.addEventListener("mouseup",(function(e){n.handleBeingDragged=void 0,n.graphMouse=void 0})),e.addEventListener("mouseleave",(function(e){n.mouseRecentlyExitedGraph=!0})),n}}(),t=function(){var e=document.getElementById("snowflake"),t=e.getContext("2d");if(null!==t)return t.fillStyle="rgba(90, 211, 255, 1.0)",{canvas:e,ctx:t}}();if(void 0!==e&&void 0!==t)return{graph:e,graphic:t,snowflake:{faces:{growing:[{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,id:0}],grown:[],waiting:[]},branches:{growing:[],grown:[],waiting:[]}},currentGrowthType:void 0,graphMargin:10,writableGraphWidth:e.canvas.width-20,writableGraphHeight:e.canvas.height,controls:{pause:document.getElementById("pause"),reset:document.getElementById("reset"),playing:!0},step:0,intervalId:void 0,updateInterval:5,maxSteps:1e3};console.error("Couldn't get drawing context")}())&&(function(e){var t=e.controls,n=e.graphic,r=t.pause,a=t.reset;r.addEventListener("click",(function(e){t.playing=!t.playing,t.playing?(r.innerHTML="pause",n.canvas.className=""):(r.innerHTML="play",n.canvas.className="paused")})),a.addEventListener("click",(function(t){!function(e){e.snowflake={faces:{growing:[{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,id:0}],grown:[],waiting:[]},branches:{growing:[],grown:[],waiting:[]}},e.step=0,e.currentGrowthType=void 0,b(e.graphic)}(e)}))}(l),l.intervalId=window.setInterval((function(){return y(l)}),l.updateInterval))})();