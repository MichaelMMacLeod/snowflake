var Main;(()=>{"use strict";var t={d:(n,e)=>{for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},o:(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},n={};t.r(n),t.d(n,{main:()=>O});var e=2*Math.PI/6,r=.001,o=.3*r,i=[-1,-.75,-.5,-.25,0,.25,.5,.75,1];function a(t,n){return(t%n+n)%n}function c(t,n,e){return(1-e)*t+e*n}function l(t){return[t(),t(),t(),t(),t(),t()]}function s(t){var n=t.r,e=t.g,r=t.b,o=t.a;return"rgba(".concat(n,", ").concat(e,", ").concat(r,", ").concat(o,")")}function g(){for(var t=[0],n=0;n<16;n++)t[n]=Math.floor(9*Math.random());return t}function h(t,n,e,r,o,i){var a=n.ctx.fillStyle,c=n.ctx.strokeStyle,l=n.ctx.getLineDash(),g=t.options.foregroundColor,h=o?8:5,u=i?[2,2]:[];n.ctx.beginPath(),n.ctx.arc(e,r,3,0,2*Math.PI),n.ctx.closePath(),n.ctx.fillStyle=s(g),n.ctx.fill(),n.ctx.closePath(),n.ctx.beginPath(),n.ctx.arc(e,r,h,0,2*Math.PI),n.ctx.strokeStyle=s(g),n.ctx.setLineDash(u),n.ctx.stroke(),n.ctx.fillStyle=a,n.ctx.strokeStyle=c,n.ctx.setLineDash(l)}function u(t,n,e){var r=n.writableGraphWidth,o=n.writableGraphHeight,a=n.graphMargin;return{x:r/(t.growthInput.length-1)*e+a,y:4*i[t.growthInput[e]]*(o/i.length)+.5*o}}function f(t,n,e){for(var r=1/0,o=0,i=0;i<t.growthInput.length;i+=1){var a=u(t,n,i).x-e.x,c=a*a;c<r&&(r=c,o=i)}return o}function d(t){t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height)}var p=[0*e,1*e,2*e,3*e,4*e,5*e];function v(){return{x:0,y:0}}function y(t,n){return{x:t.x*Math.cos(n)-t.y*Math.sin(n),y:t.x*Math.sin(n)+t.y*Math.cos(n)}}function x(t,n){var e=t.canvas.width,r=t.canvas.height;return{x:n.x*e*.5+.5*e,y:n.y*-r*.5+.5*r}}function w(t){return"none"===t.direction?0:t.direction}function m(t){for(var n="none"===t.direction?0:t.direction,e=l(v),r=0;r<p.length;r+=1){var o=p[(n+r)%p.length];e[r].x=t.center.x+t.size*Math.cos(o),e[r].y=t.center.y+t.size*Math.sin(o)}return e}var b=function(){return b=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t},b.apply(this,arguments)};function M(t){var n=p[t.direction],e=t.length;return{x:t.start.x+e*Math.cos(n),y:t.start.y+e*Math.sin(n)}}function E(t){var n=m(function(t){return b(b({},{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0}),{center:(n=t.start,{x:n.x,y:n.y}),size:t.size,direction:t.direction});var n}(t)),e=m(function(t){return b(b({},{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0}),{center:(n=t.start,e={x:t.length*Math.cos(p[t.direction]),y:t.length*Math.sin(p[t.direction])},{x:n.x+e.x,y:n.y+e.y}),size:t.size,direction:t.direction});var n,e}(t));return[e[0],e[1],n[2],n[3],n[4],e[5]]}function S(){return{left:{x:0,y:0},right:{x:0,y:0}}}function I(t){for(var n=l(S),e=0;e<p.length;e+=1)n[e].left=t[(e+1)%p.length],n[e].right=t[e];return n}function k(t,n){return r=function(t,r){return o=t,i=(r+n)%p.length,a=e*(1-i),c=y(o.left,a),l=y(o.right,a),{left:c.x,right:l.x,height:c.y};var o,i,a,c,l},t.map(r,undefined);var r}function T(t,n){if(t.height>n.height&&(t.left<n.left&&t.right>n.left||t.left>n.left&&n.right>t.left||t.left<n.left&&t.right>n.right||t.left>n.left&&t.right<n.right))return t.height-n.height}function C(t){var n=t.snowflake,e=t.graph,l=t.graphic,g=t.maxSteps,v=t.controls;if(t.step<g&&v.playing){t.step+=1;var y=function(t,n){var e=c(0,t.growthInput.length-1,n),r=function(t){return t%1}(e),o=c(i[t.growthInput[Math.floor(e)]],i[t.growthInput[Math.ceil(e)]],r);return{scale:(-.01*e+1)*Math.abs(o),growthType:o>0?"branching":"faceting"}}(e,function(t){return t.step/t.maxSteps}(t));void 0===t.currentGrowthType&&(t.currentGrowthType=y.growthType),t.currentGrowthType!==y.growthType&&(t.currentGrowthType=y.growthType,"branching"===t.currentGrowthType?function(t){t.faces.forEach((function(n){n.growing&&(function(t,n){for(var e,r=.01*n.size,o=.001+1*n.size*.99,i=n.center.x,c=n.center.y,l="none"===n.direction?[0,6]:[(e=n.direction,a(e-1,p.length)),3],s=l[1],g=l[0],h=function(e){var a=i+o*Math.cos(p[g]),l=c+o*Math.sin(p[g]),s="none"===n.direction||1===e?.9*n.growthScale:.5*n.growthScale*1;t.branches.push({start:{x:a,y:l},size:r,length:0,direction:g,growthScale:s,growing:!0}),g=function(t){return(t+1)%p.length}(g)},u=0;u<s;u+=1)h(u)}(t,n),n.growing=!1)}))}(n):function(t){t.branches.forEach((function(n){n.growing&&(function(t,n){t.faces.push({center:M(n),size:n.size,direction:n.direction,growthScale:n.growthScale,growing:!0})}(t,n),n.growing=!1)}))}(n));var b=function(t){var n=[[],[],[],[],[],[]];return t.faces.forEach((function(t){var e;(e=t,k(function(t){return I(m(t))}(e),w(e))).forEach((function(e,r){var o=(r+w(t))%p.length;n[o].push(e)}))})),t.branches.forEach((function(t){var e;(e=t,k(function(t){return I(E(t))}(e),e.direction)).forEach((function(e,r){var o=(r+t.direction)%p.length;n[o].push(e)}))})),n}(n);"branching"===t.currentGrowthType?(function(t,n){t.branches.forEach((function(e,r){if(r+=t.faces.length,e.growing){for(var o=e.direction,i=o,c=a(o-1,p.length),l=n[i][r],s=n[c][r],g=n[i],h=n[c],u=0;u<g.length;++u)if(u!==r&&void 0!==T(g[u],l)){e.growing=!1;break}if(e.growing)for(u=0;u<h.length;++u)if(u!==r&&void 0!==T(h[u],s)){e.growing=!1;break}}}))}(n,b),n.branches.forEach((function(t){var n,e,i,a;t.growing&&(n=t,i=-1.5*(e=y.scale)+1.5,a=1.5*e,n.size+=a*o*n.growthScale,n.length+=i*r*n.growthScale)}))):(function(t,n){t.faces.forEach((function(t,e){if(t.growing){for(var r=w(t),o=r,i=a(r-1,p.length),c=n[o][e],l=n[i][e],s=n[o],g=n[i],h=0;h<s.length;++h)if(h!==e&&void 0!==T(s[h],c)){t.growing=!1;break}if(t.growing)for(h=0;h<g.length;++h)if(h!==e&&void 0!==T(g[h],l)){t.growing=!1;break}}}))}(n,b),n.faces.forEach((function(t){t.growing&&function(t,n){if(t.size+=.75*n*r*t.growthScale,"none"!==t.direction){var e=.75*n*r*Math.cos(p[t.direction])*t.growthScale,o=.75*n*r*Math.sin(p[t.direction])*t.growthScale;t.center.x+=e,t.center.y+=o}}(t,y.scale)}))),d(l),function(t,n){n.faces.forEach((function(n){return function(t,n){"none"===n.direction||n.direction,t.ctx.beginPath(),m(n).forEach((function(n,e){var r=x(t,n),o=r.x,i=r.y;0===e?t.ctx.moveTo(o,i):t.ctx.lineTo(o,i)})),t.ctx.closePath(),t.ctx.fillStyle="rgba(255, 255, 255, 1)",t.ctx.fill()}(t,n)})),n.branches.forEach((function(n){return function(t,n){t.ctx.beginPath(),E(n).forEach((function(n,e){var r=x(t,n),o=r.x,i=r.y;0===e?t.ctx.moveTo(o,i):t.ctx.lineTo(o,i)})),t.ctx.closePath(),t.ctx.fillStyle="rgba(255, 255, 255, 1)",t.ctx.fill()}(t,n)}))}(l,n)}!function(t,n){!function(t,n,e){void 0===t.installation?e():n(t.installation)}(t,n,(function(){}))}(e,(function(n){(function(t,n){if(void 0!==n.handleBeingDragged||n.mouseRecentlyExitedGraph){n.mouseRecentlyExitedGraph=!1;var e="needs lookup"===n.handleBeingDragged&&void 0!==n.graphMouse?f(t,n,n.graphMouse):n.handleBeingDragged;if("needs lookup"===n.handleBeingDragged&&(n.handleBeingDragged=e),void 0!==n.graphMouse&&"needs lookup"!==e){var r=n.writableGraphHeight/i.length,o=Math.floor(n.graphMouse.y/r);void 0!==e&&(t.growthInput[e]=(a=o,c=i.length-1,Math.min(Math.max(a,0),c)))}}var a,c,l=void 0!==n.handleBeingDragged?"none":"auto",s=function(t){return t.setAttribute("style","user-select: ".concat(l))};Array.from(document.getElementsByClassName("graphLabel")).forEach(s),Array.from(document.getElementsByClassName("control")).forEach(s);var g=document.getElementById("controlContainer");null!==g&&s(g)})(e,n),n.ctx.clearRect(0,0,n.canvas.width,n.canvas.height),function(t,n,e,r){var o=n.writableGraphWidth,i=n.writableGraphHeight,a=n.graphMargin,c=e/r,l=n.ctx.fillStyle;n.ctx.fillStyle=s(t.options.progressColor),n.ctx.fillRect(a,0,o*c,i),n.ctx.fillStyle=l,n.ctx.beginPath();var g=u(t,n,0);n.ctx.moveTo(g.x,g.y);for(var d=1;d<t.growthInput.length;d+=1)g=u(t,n,d),n.ctx.lineTo(g.x,g.y);for(n.ctx.strokeStyle=s(t.options.foregroundColor),n.ctx.stroke(),d=0;d<t.growthInput.length;d+=1)if(g=u(t,n,d),void 0!==n.graphMouse){var p=f(t,n,n.graphMouse);h(t,n,g.x,g.y,d===p,d===n.handleBeingDragged)}else h(t,n,g.x,g.y,!1,!1);n.ctx.beginPath();var v=o*c+a;n.ctx.moveTo(v,0),n.ctx.lineTo(v,i),n.ctx.strokeStyle=s(t.options.progressLineColor),n.ctx.stroke(),n.ctx.beginPath();var y=.5*i;n.ctx.moveTo(a,y),n.ctx.lineTo(o+a,y),n.ctx.strokeStyle=s(t.options.foregroundColor),n.ctx.setLineDash([2,2]),n.ctx.stroke(),n.ctx.setLineDash([])}(e,n,t.step,g)}))}function L(t){var n=t;return(null!==n&&"object"==typeof n||"function"==typeof n)&&"number"==typeof n.r&&"number"==typeof n.g&&"number"==typeof n.b&&"number"==typeof n.a}function O(t){var n,e,r,o=t({snowflakeInstallationElement:document.body,controlsInstallationElement:document.body,graphOptions:{progressColor:{r:255,g:255,b:255,a:1},progressLineColor:{r:255,g:255,b:255,a:1},backgroundColor:{r:0,g:0,b:0,a:1},foregroundColor:{r:0,g:0,b:0,a:1}},graphInstallationOptions:{mouseUpEventListenerElement:document,canvasParent:document.body,canvasClassName:"graph",canvasWidth:600,canvasHeight:200}});if((null!==(i=o)&&"object"==typeof i||"function"==typeof i)&&i.snowflakeInstallationElement instanceof HTMLElement&&(void 0===i.controlsInstallationElement||i.controlsInstallationElement instanceof HTMLElement)&&(null!==i.graphOptions&&"object"==typeof i.graphOptions||"function"==typeof i.graphOptions)&&L(i.graphOptions.progressColor)&&L(i.graphOptions.progressLineColor)&&L(i.graphOptions.backgroundColor)&&L(i.graphOptions.foregroundColor)){var i,a=function(t){var n=function(t){return{options:t,growthInput:g(),installation:void 0}}(t.graphOptions);void 0!==t.graphInstallationOptions&&function(t,n){if(void 0===t.installation){var e=document.createElement("canvas");e.width=n.canvasWidth,e.height=n.canvasHeight,e.className=n.canvasClassName;var r=e.getContext("2d");null!==r&&(n.canvasParent.appendChild(e),t.installation={options:n,canvas:e,ctx:r,handleBeingDragged:void 0,mouseRecentlyExitedGraph:!1,graphMouse:void 0,graphMargin:10,writableGraphWidth:e.width-20,writableGraphHeight:e.height},e.addEventListener("mousemove",(function(n){void 0!==t.installation&&(t.installation.graphMouse={x:n.offsetX,y:n.offsetY})})),e.addEventListener("mousedown",(function(n){void 0!==t.installation&&(t.installation.handleBeingDragged="needs lookup")})),n.mouseUpEventListenerElement.addEventListener("mouseup",(function(n){void 0!==t.installation&&(t.installation.handleBeingDragged=void 0,t.installation.graphMouse=void 0)})),e.addEventListener("mouseleave",(function(n){void 0!==t.installation&&(t.installation.mouseRecentlyExitedGraph=!0)})))}else console.error("attempt to install graph twice")}(n,t.graphInstallationOptions);var e=function(){var t=document.getElementById("snowflake"),n=t.getContext("2d");if(null!==n)return n.fillStyle="rgba(90, 211, 255, 1.0)",{canvas:t,ctx:n}}();if(void 0!==e)return{graph:n,graphic:e,snowflake:{faces:[{center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0}],branches:[]},currentGrowthType:void 0,controls:{pause:document.getElementById("pause"),reset:document.getElementById("reset"),playing:!0},step:0,intervalId:void 0,updateInterval:5,maxSteps:1e3};console.error("Couldn't get drawing context")}(o);void 0!==a&&(e=(n=a).controls,r=n.graphic,e.pause.addEventListener("click",(function(t){e.playing=!e.playing,e.playing?(e.pause.innerHTML="pause",r.canvas.className=""):(e.pause.innerHTML="play",r.canvas.className="paused")})),e.reset.addEventListener("click",(function(t){!function(t){var n;(n=t.snowflake).faces.length=1,n.faces[0]={center:{x:0,y:0},size:.0025,direction:"none",growthScale:1,growing:!0},n.branches.length=0,t.step=0,t.currentGrowthType=void 0,d(t.graphic)}(n)})),a.intervalId=window.setInterval((function(){return C(a)}),a.updateInterval))}else console.error("Recived bad StateOptions from onInit")}Main=n})();